# 草台班子学校之废弃服务器从占领到放弃

## 引言

* 一切的起因, 大概是要感谢我们的某位群友, 易姐. 据其描述曾把其高中时的学校监控什么的骇进去了, 而咱只有羡慕实力的份了
* 但在这破学校里, 闲着也是闲着, 不如就以教室电脑为基础, 搞点事情吧, 万一有什么意外的发现呢? 也权当是开阔眼界了吧

## 最初之准备

* 虽然咱学校电脑用的是讨厌的 Windows, 但这不影响我们干事
* 咱在里面装了 Zenmap (就是 Nmap 的图形客户端), Wireshark, TigerVNC Viewer & Server, OpenSSH Server, Msys2, Ungoogled Chromium, LibreOffice, etc. 就是用不用的上的东西全装了
* 最初的目的很简单, 乱扫一遍, 向大佬学习嘛

## 发现众设备

### Nmap (Zenmap) 使用初体验

* 那天装好 Nmap 打开时刚好下节是体育, 正不巧班主任也进来了, 还好没发生什么意外
* 打开后, 迎面而来的, 便是浓重的 GTK 味, 就我这近两年的 Linux 经验, 不会错的. 而后来还有打开安装目录观察过, 是 GTK 无疑了, 还是讨厌的 Python 写的 GUI, 另外那 Python 是 GCC 而不是 MSVC 编译的, 这点好评
* 中文肯定没有的, 反正咱也看得懂英文, 都是字面意思, 熟悉的词汇, 上手门槛还是比较低的
* 输进去要扫的主机 (们), 再选个预设, 如果你愿意还可以手动编辑命令, 然后手动 Scan 就好了
* 可以手动调深浅色, 好评

### 学校的奇怪网络架构

* 教室的电脑是 `172.16.xxx.55` 具体不记得, 我便以 `/24` 开始进行小规模扫荡, 结果大概是些同教学楼的晚上不关机的电脑, 至于为什么是晚上? 因为我 Frp 通过 SSH 用 VNC 连上去的
* 同一操作白天也试了, 设备明显多了, 不过多是 Windows 罢了, 都不是咱感兴趣的目标
* 而后咱将目标转向科技楼, 就是那堆信息教室的所在地, 那边 IP 在信息课上早已烂熟于心: `192.168.0.0/16`, 开扫
* 然后极具戏剧性的事件发生了, 扫了一两节课后, 看着无比缓慢的进度, 我陷入沉思, 随后看着那个 `192.168.0.0/8` 呆住了. 啊! 手残打错掩码了! 我这下是扫出一堆互联网基础设施了, 随即进行更正再来
* 扫描配置咱用的是默认之一的 `Intense Scan, All TCP ports`, 然后有时开扫没多久就挂了. 我疑是杀软起作用或权限不够, 便专门关掉火绒, 以管理员身份运行了 Zenmap, 然后开扫, 寄! 又疑是学校网络太烂, 观察日志, 发现是在反向 DNS 解析时挂掉的,这下 DS 帮上了忙, 加了个参关掉反向解析, 再没挂过
* 科技楼是 `192.168.0.0/16`, 我发现了许多正在上课的 Windows 设备, 大概 IP 的规则是第 16-23 位 (zero-based index) 代表机房编号, 如二号机房就是 `192.168.20.0/24`, 但我却意外发现了不存在的六号机房, 而且里面还有 Xbox 主机?
* 再次回到我们的教学楼, 这次我们的目标是 `172.16.0.0/16`, 开扫, 经过好多节课的扫描后, 结果出来了. 其中我发现了几台有意思的主机, 一只海康的摄像头, 一只大华的录像机, 几只开了很多服务的 Linux 和 BSD 服务器
* 那段时间是问 DS 有关如何处理录像机的, 群友没有提供帮助, 试了很多密码也没能成功, 遂放弃, 另外看数量也没觉得像是主要监控更像是某个班主任自己的?
* 在众多 Linux 服务器中, 有一台成功引起了我的注意, 其开放了大量端口, 如 SSH, FTP, 好多 HTTP, 好多 VNC, 抱着试试看的想法连上一个 VNC 端口, 发现是 QEMU, 跑的是 Windows 7, 账密都是 h3school, 不禁窃喜, 准备有所大动作
* 后面还对 `10.0.0.0/8` 进行了扫描, 与前面许多次的结果进行整合, 我得出结论, 学校的网络依 (yì) 托 (tuó) 构 (gŏu) 思 (shǐ), 大概推测如下
  ```text
  internet
   \ 10.10.10.1
      + 192.168.0.0/16
      |  \ 科技楼众机房等
      + 172.16.0.0/16
      |  + 高中教学楼
      |  \ 初中部
      \ 顶部其余基础设施
  ```

### 尘封已久的废弃服务器

* 那台成功引起我注意的服务器的 IP 是 `172.16.122.254`, 非常普通
* 连上 QEMU 的虚拟机后, 我将目标转向主机本身, 看看能否有所发现
* 先是打开 Chromium, 输入地址, 回车, 与此前虚拟机一致, h3school, 让我输账密
* 不知是哪来的经验, 上来就是 `admin/admin`, 然后登录成功, 咱充满惊讶
* 更惊讶的不止于此, 面板上还显示了大概的配置信息, 特别是 256G 内存, 知道这意味着什么嘛? 我曾经那台 07 年的联想电脑是 160G 的机械硬盘, 我现在用的垃圾 Redmin 14R 存储空间只有 128G, 这个数字无法想象
* 在 Web 面板探索了没一会就生厌了, 除了控制一个班级数量的 Windows 虚拟机外也没什么能做的了, 看看面板的日志, 服务器大概是 12 年的, 平均一年使用一次, 而今年却偏偏没有使用上, 真奇怪
* 接着, 我打算看看 SSH, 同样是上来就 `root/root`, 然后我看到了 motd 被打印出来, 接着是普普通通的提示符 `root@CloudClass:~#`, 没有人知道当时咱心中的复杂思想感情, 符使现在我也不记得当时的想法了
* 那台服务器用的是古老的 Ubuntu 12.04.02 系统, 早已停止了支持, 还是 `lsb_release` 才得知的

## 高性能废弃服务器

* 那服务器实在是老的无法形容的, dpkg 压根不支持 XZ 格式, 这意味着现代的 DEB 软件包无法安装, 甚至 `sources.list` 里的仓库地址也是个不存在的内网地址
* 而且那服务器的 `resolv.conf` 还是被一个不知道是干啥的东西管理, 也找不到配置, 指向的是一个不存在的内网地址, 我手动改成了 `nameserver 8.8.8.8` 等内容, 还装了个 Frp 这样就能在家访问了
* 那天晚上, 忍无可忍, 直接一个 `do-release-upgrade`, 经过半个d多小时的等待, 好消息是升级成功服务器没挂, 坏消息是服务挂了, h3school 的 Web 挂掉了
* 尝试用 root 用户家目录下的脚本安装, 可发现怎么也装不上, 具体表现为 Python 版本问题及 Docker 守护进程配置问题及 libvirt 依赖问题, 但最起码好歹 80 的 Web 服务能访问了, 但是原先的各种配置好像都没有了, 但我也不想管了, 反正我没受影响
* 终于装上了 neofetch, htop 这些东西, 让我看看服务器的基本配置. 然后是, CPU 是 32 核的 E5, GPU 是搜都搜不到的, 内存是 256G 的, 服务器型号是 PowerEdge 什么的: 大概就是, 好, 很好, 非常好, 不送我就是资源的浪费
* 接着是手写 QEMU 启动命令, 用 KVM 虚拟化启动虚拟机自用, 既然主机太旧那就去虚拟机玩, 咱用的 Debian 12, 因为那时还没有 13
* 最初安全意识薄弱, 我只是自建了个用户也用比较弱的密码, 装的虚拟机磁盘映像也没做全盘加密, 还直接裸连 VNC, 在上面看消息什么的, 危险的不得了
* 发生了一次社会工程学攻击后, [具体细节](https://t.me/sesstimes/126) TG 发过, 我又建了个新的, 在自习课上用教室电脑在上面全盘加密安装了 Debian, 密码强度也算有所改进
* 暑假期间, 教室电脑被不明人员开开关关, 甚至开学后还发现 TigerVNC 被人给卸载了, 而那台服务器好好的,除了有几次莫名因为网络异常下线了一会儿. 咱在上面运行了很多东西, 比如 TG 的 Bot, 还分享给社团同学使用, 另外还计划出租虚拟机, 咱还在上面做过几个视频 (虽然数据不是很理想)
* 就这样服务器经过我的, 安全审计, 资源盘活, 合理利用, 成为了一个在学校可以长期使用的据点, 假期用作生产服务器, 上学时用于浏览消息等, 如果一直持续下去会是多么美好啊!
* 这个学期开学后, 我从裸连 VNC 改为了 SSH 反代虚拟机的自签证书的 HTTPS 的 noVNC 流量, 在学校的安全性应该是大大提高了
* 为了更好的上信息课, 咱还研究了下那服务器上原有的 OVS, 把 Kali 虚拟机通过 OVS 获得了 `172.16.122.250` 这个 IP 地址, 在周六时对信息老师的 `192.168.20.200` 进行了大约六小时的安全测试, 最终手试密码一次就进了 FTP 和 SMB 服务器, 而 MySQL, Tomcat, IIS, RDP 这些都没能攻破, 不用想, 学校交换机日志肯定充满了我的记录

## 终章之放弃孤岛

* 可能是 "异常" 流量过多, 也可能是学校相关人员的 "误操作", 在那个著名历史事件的纪念日, 那个某职业人群的节日的第二天, 下午 4:08, 公网断了, 这是一次大概永久性的社会工程学攻击
* [具体经过](https://t.me/sesstimes/247) 咱在 TG 也发过了, 总结来说是, 数据和服务需要立即进行迁移, 我们不得不回退到 Termux 这个糟糕的环境, 服务器没得用了
* 或许确实要好好考虑手搓基于树莓派的平板了, 不得不去花钱寻求更稳定和持久和高性能的服务了
* 免费的东西, 还是高性能的好东西, 不可能长久, 曾经真是难得的拥有的幸运
* 也没人去请咱去喝茶, 写下此文, 纪念那段 "实验云" 的往事吧
* 羡慕你们

*2025-09-12T20:40+08:00*  
*Session Hu 于学校教室*

~~9 月 28 日追加: 9 月 27 日下午, Uptime Kuma 消息推送, 实验云复活了, 但泽生已经不再相信该服务器的可靠性, 未来将考虑将其专用于大量计算的工作, 如工作量证明和视频渲染和安全测试, 同时也对前面的部分脱敏处理~~

10 月 21 日补充: 昨日因不明原因服务器内外网相关服务均已无法连接, 大概是真无了, 一切似乎结束了
